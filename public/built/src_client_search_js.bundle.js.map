{"version":3,"file":"src_client_search_js.bundle.js","mappings":"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","sources":["webpack://fartza.ru/./src/client/search.js"],"sourcesContent":["import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { setLastArgs } from \"./store/reducers/goods_slice\";\r\nimport { goodsAPI } from \"./store/services/goods_service\";\r\n\r\nclass Search extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.getGoods = this.getGoods.bind(this);\r\n\t\tthis.getGoodsURL = this.getGoodsURL.bind(this);\r\n\t\tthis.getGoodsEnter = this.getGoodsEnter.bind(this);\r\n\t\tthis.reset = this.reset.bind(this);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tlet searchParams = new URLSearchParams(location.search);\r\n        if (searchParams.get('query') && searchParams.get('query').length > 1) {\r\n        \t/*let params = new URLSearchParams(new URL(window.location.href).search);\r\n\t\t\tlet query;\r\n\t\t\tlet sort;\r\n\t\t\tfor(let pair of params.entries()) {\r\n\t\t\t  if (pair[0] == 'query') {\r\n\t\t\t  \tquery = pair[1];\r\n\t\t\t  }\r\n\t\t\t  else if (pair[0] == 'sort') {\r\n\t\t\t  \tsort = pair[1];\r\n\t\t\t  }\r\n\t\t\t}*/\r\n\t\t\tlet searchParams = new URLSearchParams(location.search);\r\n\t\t\tlet query = searchParams.get('query');\r\n\t\t\t//let sort = searchParams.get('sort');\r\n        \tdocument.getElementById(\"search\").value = query;\r\n\t\t\t//this.getGoodsURL(query, 0, sort);\r\n\t\t}\r\n    }\r\n\r\n\tgetGoodsURL(query, since, sort) {\r\n\t\t/*fetch('/api', {\r\n\t\t\tmethod: 'POST',\r\n\t\t    headers: {\r\n\t\t      'Accept': 'application/json',\r\n\t\t      'Content-Type': 'application/json'\r\n\t\t    },\r\n\t\t    body: JSON.stringify({ command: 'searchGoods', word: query, since: since, sort: sort })\r\n\t\t}).then(response => {\r\n\t\t\tresponse.json().then(body => {\r\n\t\t\t\tthis.props.updateGoods(body.goods[0]);\r\n\t\t\t});\r\n\t\t});*/\r\n\t\t/*this.props.sendAPIRequest({ command: 'searchGoods', word: query, since: since, sort: sort }, '/api', 'POST').then(resolve => {\r\n\t\t\tif (resolve.body.goods[0].length == 0) {\r\n\t\t\t\tthis.props.updateGoods('Ничего не найдено!');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.props.updateGoods(resolve.body.goods[0]);\r\n\t\t}).catch(reject => {\r\n\t\t\tthis.props.updateGoods(reject.error);\r\n\t\t});*/\r\n\t\tsort = sort ?? 'new';\r\n\t\tthis.props.fetchAllGoods({ word: query, since, sort });\r\n\t\tthis.props.setLastArgs({ word: query, since, sort });\r\n\t}\r\n\r\n\t/*getGoods(event) {\r\n\t\tfetch('/api', {\r\n\t\t\tmethod: 'POST',\r\n\t\t    headers: {\r\n\t\t      'Accept': 'application/json',\r\n\t\t      'Content-Type': 'application/json'\r\n\t\t    },\r\n\t\t    body: JSON.stringify({ command: 'searchGoods', word: document.getElementById(\"search\").value, since: 0 })\r\n\t\t}).then(response => {\r\n\t\t\tresponse.json().then(body => {\r\n\t\t\t\temitter.emit(\"CHANGE\", body.goods[0]);\r\n\t\t\t});\r\n\t\t});\r\n\t}*/\r\n\r\n\tgetGoods(event) {\r\n\t\t/*const url = new URL(window.location);\r\n\t\turl.searchParams.set('search', 'true');\r\n\t\turl.searchParams.set('query', document.getElementById(\"search\").value);\r\n        url.pathname = \"/\";\r\n\t\twindow.history.pushState({}, '', url);*/\r\n\t\tif (document.getElementById(\"search\").value.length > 1) {\r\n\t\t\tlet searchParams = new URLSearchParams(location.search);\r\n\t\t\tsearchParams.set('query', document.getElementById(\"search\").value);\r\n\t\t\twindow.history.replaceState({}, '', `${location.pathname}?${searchParams}`);\r\n\t\t\t//window.location.reload();\r\n\t\t\t/*let params = new URLSearchParams(new URL(window.location.href).search);\r\n\t\t\tlet sort;\r\n\t\t\tfor(let pair of params.entries()) {\r\n\t\t\t\tif (pair[0] == 'sort') {\r\n\t\t\t\t\tsort = pair[1];\r\n\t\t\t\t}\r\n\t\t\t}*/\r\n\t\t\tlet sort = searchParams.get('sort');\r\n\t\t\tthis.getGoodsURL(document.getElementById(\"search\").value, 0, sort);\r\n\t\t}\r\n\t}\r\n\r\n\tgetGoodsEnter(event) {\r\n\t\tif (event.keyCode == 13) {\r\n\t\t\tthis.getGoods(event);\r\n\t\t}\r\n\t}\r\n\r\n\treset(event) {\r\n\t\tlet searchParams = new URLSearchParams(location.search);\r\n\t\tsearchParams.set('query', '');\r\n\t\twindow.history.replaceState({}, '', `${location.pathname}?${searchParams}`);\r\n\t\tdocument.getElementById(\"search\").value = \"\";\r\n\t\tlet sort = searchParams.get('sort');\r\n\t\tthis.getGoodsURL(\"\", 0, sort);\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n            <div id=\"search-wrapper\" className=\"border-bottom\">\r\n                <div style={{textAlign: 'center', marginBottom: '25px'}}>\r\n                    <input type=\"text\" className=\"form-control\" id=\"search\" style={{display: 'inline', width: '60vw', marginRight: '10px', verticalAlign: 'middle'}} onKeyUp={this.getGoodsEnter} />\r\n                    <button type=\"button\" className=\"btn btn-primary\" onClick={this.getGoods} style={{display: 'inline', verticalAlign: 'middle'}}>Найти!</button>\r\n\t\t\t\t\t<button type=\"button\" className=\"link-secondary res\" onClick={this.reset} style={{display: 'inline', verticalAlign: 'middle'}}>Сбросить</button>\r\n\t\t\t\t</div>\r\n            </div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n/*const mapStateToProps = (state) => {\r\n    return {\r\n\t\tfetchAllGoodsState: (args) => goodsAPI.endpoints.fetchAllGoods.select(args)(state),\r\n\t\tlastArgs: state.goodsReducer.lastArgs\r\n    };\r\n}*/\r\n\r\nconst mapDispatchToProps = {\r\n    fetchAllGoods: goodsAPI.endpoints.fetchAllGoods.initiate,//(args) => dispatch(goodsAPI.endpoints.fetchAllGoods.initiate(args)) //(args) => dispatch(getGoodsFromAPI(args))\r\n\tsetLastArgs: setLastArgs\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(Search);"],"names":["React","connect","setLastArgs","goodsAPI","Search","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","getGoods","bind","_assertThisInitialized","getGoodsURL","getGoodsEnter","reset","_createClass","key","value","componentDidMount","searchParams","URLSearchParams","location","search","get","length","query","document","getElementById","since","sort","_sort","fetchAllGoods","word","event","set","window","history","replaceState","concat","pathname","keyCode","render","createElement","id","className","style","textAlign","marginBottom","type","display","width","marginRight","verticalAlign","onKeyUp","onClick","Component","mapDispatchToProps","endpoints","initiate"],"sourceRoot":""}